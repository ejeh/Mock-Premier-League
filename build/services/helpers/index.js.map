{"version":3,"sources":["../../../src/services/helpers/index.js"],"names":["saltRounds","hashPassword","plaintextPassword","bcrypt","hash","comparePasswords","password","compare","getClientDetails","req","findEmail","User","email","Promise","resolve","reject","findOne","select","exec","err","result"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AAEO,IAAMA,UAAU,GAAG,EAAnB;;;SACeC,Y;;;;;;;+BAAf,iBAA4BC,iBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA,6CACEC,qBAAOC,IAAP,CAAYF,iBAAZ,EAA+BF,UAA/B,CADF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;SAIeK,gB;;;;;;;+BAAf,kBAAgCC,QAAhC,EAA0CF,IAA1C;AAAA;AAAA;AAAA;AAAA;AAAA,8CACED,qBAAOI,OAAP,CAAeD,QAAf,EAAyBF,IAAzB,CADF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAIA,SAASI,gBAAT,CAA0BC,GAA1B,EAA+B;AACpC;AACA;AACA;AACA,SAAO,WAAP;AACD;;AAEM,SAASC,SAAT,CAAmBC,IAAnB,EAAyBC,KAAzB,EAAgC;AACrC,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCJ,IAAAA,IAAI,CAACK,OAAL,CAAa;AAAEJ,MAAAA,KAAK,EAALA;AAAF,KAAb,EACGK,MADH,CACU,WADV,EAEGC,IAFH,CAEQ,UAACC,GAAD,EAAMC,MAAN,EAAiB;AACrB,UAAID,GAAJ,EAASJ,MAAM,CAACI,GAAD,CAAN;AACT,aAAOL,OAAO,CAACM,MAAD,CAAd;AACD,KALH;AAMD,GAPM,CAAP;AAQD","sourcesContent":["import bcrypt from \"bcryptjs\";\n\nexport const saltRounds = 10;\nexport async function hashPassword(plaintextPassword) {\n  return bcrypt.hash(plaintextPassword, saltRounds);\n}\n\nexport async function comparePasswords(password, hash) {\n  return bcrypt.compare(password, hash);\n}\n\nexport function getClientDetails(req) {\n  // const acceptLanguage = req.get(\"accept-language\");\n  // const userAgent = req.get(\"user-agent\");\n  // return `${userAgent}/${acceptLanguage}`;\n  return \"aa_device\";\n}\n\nexport function findEmail(User, email) {\n  return new Promise((resolve, reject) => {\n    User.findOne({ email })\n      .select(\"+password\")\n      .exec((err, result) => {\n        if (err) reject(err);\n        return resolve(result);\n      });\n  });\n}\n"],"file":"index.js"}